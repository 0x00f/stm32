Project template created by gen-stm32f407-GCC-project.sh mbed-none
   mbed-none ... creates a bare-metal project with mbed SDK

cd ~/stm32/
git submodule update --init
cd ~/stm32/cpputest
./autogen.sh
mkdir ~/stm32/examples/Template.mbed-cpputest
cd ~/stm32/examples/Template.mbed-cpputest
patch -p1 < PeripheralNames.patch

mkdir build
cd build
~/stm32/cpputest/configure --host=arm-none-eabi --prefix=/home/iztok/stm32/examples/test2/lib/cpputest --with-gnu-ld LDFLAGS='--specs=nosys.specs -mcpu=cortex-m4 -mthumb -mlittle-endian -mfpu=fpv4-sp-d16 -mfloat-abi=hard -mthumb-interwork -Os -Wl,-gc-sections --specs=nano.specs' CFLAGS='-mcpu=cortex-m4 -mthumb -mlittle-endian -mfpu=fpv4-sp-d16 -mfloat-abi=hard -mthumb-interwork -std=c99 -Os -ffunction-sections -fdata-sections -fno-builtin' CXXFLAGS='-mcpu=cortex-m4 -mthumb -mlittle-endian -mfpu=fpv4-sp-d16 -mfloat-abi=hard -mthumb-interwork -Os -ffunction-sections -fdata-sections -fno-builtin -fno-rtti'
make -j8
make check
make install

#cp -r ~/stm32/cpputest/include .
#find include/Platforms -mindepth 1 -maxdepth 1 -type d -not -name 'Gcc' -exec rm -rf {} \;
